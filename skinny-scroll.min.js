!function(t,e){function i(e,o){this.config=p.extend(i.defaults,o),this.events={scroll:new h},this.el=p.query(e)||e,this.el.style.overflow="hidden",this.page=new s(this,this.el.children[0]),this.sbar=new r(this,this.page),this.el.appendChild(this.sbar.el),this.controllers=[],this.controllers.push(new n(this,this.page)),this.controllers.push(new a(this,this.page)),this.redraw(),this._redraw=p.bind(this.redraw,this),p.on(t,"resize",this._redraw)}function n(t,e){this.main=t,this.page=e,this.y=0,t.events.scroll.on(function(t){this.y=parseFloat(t)},this),this._scroll=p.bind(this.scroll,this),p.on(t.el,"DOMMouseScroll mousewheel",this._scroll)}function s(t,e){this.main=t,this.el=e,this.morph=new Morph(e),this.morph.on("update",p.bind(this.update,this))}function o(t,e,i,n){this.main=t,this.page=e,this.sbar=i,this.hand=n,this._lock=p.bind(this.lock,this),this._drag=p.bind(this.drag,this),p.on(i,"mousedown",this._lock),p.on(n,"mousedown",this._lock),this.dragging=!1,this.offset=0}function r(t,i){this.main=t,this.page=i;var n=t.config.color,s=t.config.radius,r=t.config.width;this.el=e.createElement("div"),p.css(this.el,{position:"absolute",right:0,top:2,bottom:2,width:r+2,zIndex:90}),this.el.className="skinnyscrollbar",this.back=p.append(this.el,{backgroundColor:n,filter:"alpha(opacity=20)",opacity:"0.2",borderRadius:s,position:"absolute",left:0,top:0,bottom:0,width:r}),this.hand=p.append(this.el,{backgroundColor:n,filter:"alpha(opacity=40)",opacity:"0.4",borderRadius:s,position:"absolute",left:0,top:0,width:r,height:7}),new o(t,i,this.el,this.hand),t.events.scroll.on(this.y,this)}function h(){this.c=[]}function a(t,e){this.main=t,this.page=e,this.x=0,this.y=0,p.on(e.el,"touchstart",this)}var p={extend:function(t,e){for(var i in e)t[i]=e[i];return t},query:function(t,i){return"string"!=typeof t?null:(i=i||e,i.querySelector(t))},clamp:function(t,e,i){return e>t?e:t>i?i:t},append:function(t,i,n){var s=e.createElement(n||"div");return p.css(s,i),t.appendChild(s)},bind:function(t,e){return function(){t.apply(e,[].slice.call(arguments))}},invoke:function(t,e){for(var i=slice.call(arguments,2),n=0;n<t.length;n++)t[n][e].apply(t[n],i)},on:function(t,e,i){for(var n=e.split(" "),s=0;s<n.length;s++)t.attachEvent?t.attachEvent("on"+n[s],i):t.addEventListener(n[s],i,!1)},off:function(t,e,i){for(var n=e.split(" "),s=0;s<n.length;s++)t.detachEvent?t.detachEvent("on"+n[s],i):t.removeEventListener(n[s],i,!1)},css:function(t,e){for(var i in e)try{t.style[p.camel(i)]=p.addUnit(e[i])}catch(n){}},camel:function(t){return(""+t).replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},addUnit:function(t){return"string"==typeof t?t:t+"px"},getPointer:function(t){var i=t.pageX,n=t.pageY;if(t.touches&&(i=t.touches[0].pageX,n=t.touches[0].pageY),null==i){var s=e.documentElement,o=e.body;i=t.clientX+(s.scrollLeft||o.scrollLeft||0)-(s.clientLeft||o.clientLeft||0),n=t.clientY+(s.scrollTop||o.scrollTop||0)-(s.clientTop||o.clientTop||0)}return{x:i,y:n}},getOffset:function(i){var n=e.documentElement,s=i.getBoundingClientRect(i);return{top:s.top+(t.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(t.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}},lerp:function(t,e,i){return e+(i-e)*t},norm:function(t,e,i){return(t-e)/(i-e)},map:function(t,e,i,n,s){return p.lerp(p.norm(t,e,i),n,s)}};i.defaults={color:"#fff",radius:6,width:6},i.prototype.height=function(){return this.el.offsetHeight},i.prototype.y=function(t){this.page.morph.set("y",t)},i.prototype.redraw=function(){this.sbar.redraw()},i.prototype.destroy=function(){p.invoke(this.controllers,"destroy"),p.off(t,"resize",this._redraw),this.sbar.destroy()},t.SkinnyScroll=i,function(t,e){function i(t){return this instanceof i?(this.el=h.query(t)||t,this.events={update:new n,end:new n},this.engine=i.support.transition?new o(this):new s(this),void this.duration(i.defaults.duration)):new i(t)}function n(){this.c=[]}function s(t){this.main=t,this.el=t.el,this._start={},this._end={}}function o(t){this.main=t,this.el=t.el,this._update=h.bind(this.update,this),this._end=h.bind(this.end,this),this.reset()}var r=e.createElement("div").style,h={extend:function(t,e){for(var i in e)t[i]=e[i];return t},bind:function(t,e){return function(){t.apply(e,[].slice.call(arguments))}},style:function(e,i){return t.getComputedStyle?getComputedStyle(e).getPropertyValue(h.uncamel(i)):e.currentStyle?e.currentStyle[h.camel(i)]:e.style[h.camel(i)]},matrix:function(t){var e=t.match(/\(([-\d., ]+?)\)/)[1].split(", ");return 6==e.length?{x:e[4],y:e[5]}:16==e.length?{x:e[12],y:e[13]}:void 0},contains:function(t,e){for(var i in t)if(t[i]===e)return!0;return!1},query:function(t,i){return"string"!=typeof t?null:(i=i||e,i.querySelector(t))},vendorPropName:function(t){if(t in r)return t;for(var e=h.camel("-"+t),i=["Moz","Webkit","O","ms"],n=0;n<i.length;n++)if(t=i[n]+e,t in r)return t},has3d:function(){var t=h.vendorPropName("transform");return r[t]="",r[t]="rotateY(90deg)",""!==r[t]},on:function(t,e,i){for(var n=e.split(" "),s=0;s<n.length;s++)t.attachEvent?t.attachEvent("on"+n[s],i):t.addEventListener(n[s],i,!1)},off:function(t,e,i){for(var n=e.split(" "),s=0;s<n.length;s++)t.detachEvent?t.detachEvent("on"+n[s],i):t.removeEventListener(n[s],i,!1)},camel:function(t){return(""+t).replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},uncamel:function(t){return(""+t).replace(/([A-Z])/g,"-$1").toLowerCase()},addUnit:function(t){return"string"==typeof t?t:t+"px"},getUnit:function(t){return"string"==typeof t?t.replace(/[-\d\.]/g,""):"px"},num:function(t){return+(""+t).replace(/[^-\d.]/g,"")},lerp:function(t,e,i){return e+(i-e)*t}};i.defaults={duration:500},i.support={transition:h.vendorPropName("transition"),transform:h.vendorPropName("transform"),transform3d:h.has3d()},i.prototype.duration=function(t){return this.engine.duration(t),this},i.prototype.get=function(t){return this.engine.get(t)},i.prototype.set=function(t,e){return this.engine.set(t,e),this},i.prototype.to=function(t,e){return this.engine.to(t,e),this},i.prototype.ease=function(t){return this.engine.ease(t),this},i.prototype.start=function(){return this.engine.start(),this},i.prototype.on=function(t,e){return this.events[t].on(e),this},i.prototype.off=function(t,e){return this.events[t].off(e),this},t.Morph=i,n.prototype.on=function(t,e){return this.c.push({fn:t,c:e}),this},n.prototype.fire=function(){for(var t=[].slice.call(arguments),e=0;e<this.c.length;e++)this.c[e].fn.apply(this.c[e].c||this,t);return this},n.prototype.off=function(t){if(t)for(var e=0;e<this.c.length;e++)this.c[e]===t&&(this.c.splice(e,1),e--);else this.c=[];return this},s.aliases={x:"left",y:"top"},s.prototype.duration=function(t){this._duration=t},s.prototype.get=function(t){return t=s.aliases[t]||t,h.style(this.el,t)},s.prototype.set=function(t,e){h.extend(this._start,this.add(t,e)),this.setProperties(),this.update()},s.prototype.to=function(t,e){h.extend(this._end,this.add(t,e))},s.prototype.add=function(t,e){var i={};void 0!==e?i[t]=e:h.extend(i,t);for(var n in s.aliases)void 0!==i[n]&&(i[s.aliases[n]]=i[n],delete i[n]);return i},s.prototype.setProperties=function(){for(var t in this._start)this.el.style[h.camel(t)]=h.addUnit(this._start[t])},s.prototype.initProperties=function(){for(var t in this._end)this._start[t]||(this._start[t]=h.style(this.el,t)||1)},s.prototype.applyProperties=function(t){for(var e in this._end){var i=this._start[e],n=this._end[e],s=h.lerp(t,h.num(i),h.num(n));this.el.style[h.camel(e)]=s+h.getUnit(n)}},s.prototype.ease=function(){},s.prototype.start=function(){this.reset(),this.initProperties();var t=this,e=0,i=+new Date,n=function(){e+=(new Date-i)/t._duration,e=e>1?1:e,i=+new Date,t.applyProperties(e),t.update(),1===e&&t.end()};this.id=setInterval(n,16)},s.prototype.update=function(){this.main.events.update.fire()},s.prototype.end=function(){clearInterval(this.id),this.main.events.end.fire()},s.prototype.reset=function(){clearInterval(this.id),this._start={}},o.translate=h.has3d?["translate3d(",", 0)"]:["translate(",")"],o.ends=["transitionend","webkitTransitionEnd","oTransitionEnd","MSTransitionEnd"].join(" "),o.aliases={x:{set:function(t,e){t.transformX=o.translate.join(e+", 0")},get:function(t){return h.matrix(h.style(t,h.vendorPropName("transform"))).x}},y:{set:function(t,e){t.transformY=o.translate.join("0, "+e)},get:function(t){return h.matrix(h.style(t,h.vendorPropName("transform"))).y}}},o.prototype.reset=function(){this._props={},this._transitionProps=[],this._transforms=[],this._ease=""},o.prototype.duration=function(t){this._duration=t},o.prototype.ease=function(t){this._ease=t},o.prototype.setVendorProperty=function(t,e){this._props[h.uncamel(h.vendorPropName(t))]=e},o.prototype.get=function(t){return o.aliases[t]?o.aliases[t].get(this.el,t):h.style(this.el,h.vendorPropName(t))},o.prototype.set=function(t,e){this.duration(0),this.to(t,e),this.start(),this.update()},o.prototype.to=function(t,e){var i=this.add(t,e);for(var n in i)n.match(/^transform/)?(this.transform(i[n]),delete i[n]):(this.transition(n),this._props[n]=i[n])},o.prototype.add=function(t,e){var i={};void 0!==e?i[t]=e:h.extend(i,t);for(var n in i)if(void 0!==o.aliases[n]){var s=h.addUnit(i[n]);o.aliases[n].set(i,s),delete i[n]}return i},o.prototype.transition=function(t){h.contains(this._transitionProps,t)||this._transitionProps.push(t)},o.prototype.transform=function(t){h.contains(this._transforms,t)||this._transforms.push(t)},o.prototype.applyProperties=function(t){for(var e in t)this.el.style.setProperty(e,t[e])},o.prototype.start=function(){this._transforms.length&&(this.setVendorProperty("transform",this._transforms.join(" ")),this.transition(h.uncamel(i.support.transform))),this.setVendorProperty("transition",""),this._duration>0&&(this.setVendorProperty("transition-duration",this._duration+"ms"),this.setVendorProperty("transition-property",this._transitionProps.join(", ")),this.setVendorProperty("transition-timing-function",this._ease),clearInterval(this.id),this.id=setInterval(this._update,16),this.fired=!1,h.on(this.el,o.ends,this._end)),this.applyProperties(this._props),this.reset()},o.prototype.update=function(){this.main.events.update.fire()},o.prototype.end=function(){clearInterval(this.id),h.off(this.el,o.ends,this._end),this.fired||(this.fired=!0,this.main.events.end.fire())}}(t,e),n.prototype.scroll=function(e){if(e=e||t.event,this.page.height()>this.main.height()){e.preventDefault&&e.preventDefault();var i=e.wheelDelta?-e.wheelDelta/120:e.detail/3;return this.y-=20*i,this.y=p.clamp(this.y,-this.page.height()+this.main.height(),0),this.page.morph.set("y",this.y),!1}},n.prototype.destroy=function(){p.off(this.main.el,"DOMMouseScroll mousewheel",this._scroll)},s.prototype.height=function(){return this.el.offsetHeight},s.prototype.update=function(){this.main.events.scroll.fire(this.morph.get("y"))},o.prototype.lock=function(i){i=i||t.event,i.target=i.target||i.srcElement,this.offset=i.target==this.hand?p.getPointer(i).y-p.getOffset(this.hand).top:0,this.dragging=/mousedown/.test(i.type),this.drag(i);var n=this.dragging?"on":"off";p[n](e,"mousemove",this._drag),p[n](e,"mouseup",this._lock),p[n](e,"selectstart",this.stopSelect)},o.prototype.drag=function(e){if(e=e||t.event,this.dragging){e.preventDefault&&e.preventDefault();var i=p.getPointer(e).y-p.getOffset(this.sbar).top-this.offset,n=p.map(i,0,this.sbar.offsetHeight,0,this.page.height());return n=p.clamp(n,0,this.page.height()-this.main.height()),this.page.morph.set("y",-n),!1}},o.prototype.stopSelect=function(){return!1},r.prototype.y=function(t){this._y=t;var e=-parseFloat(t)/this.ratio;isNaN(e)&&(e=0);var i=e+this.handHeight-this.el.offsetHeight,n=this.hand.style;t>0?(n.height=Math.max(this.handHeight+e,25)+"px",n.top="0px"):i>0?(n.height=Math.max(this.handHeight-i,25)+"px",n.bottom="0px",n.top="auto"):(n.height=this.handHeight+"px",n.top=e+"px")},r.prototype.redraw=function(){var t=this.main.height(),e=t<this.page.height();this.el.style.display=e?"block":"none",this.handHeight=Math.max(t/this.page.height()*this.el.offsetHeight,25),this.ratio=(this.page.height()-t)/(this.el.offsetHeight-this.handHeight),this.y(this._y)},r.prototype.destroy=function(){var t=this.el.parentNode;t&&t.removeChild(this.el)},h.prototype.on=function(t,e){return this.c.push({fn:t,c:e}),this},h.prototype.fire=function(){for(var t=[].slice.call(arguments),e=0;e<this.c.length;e++)this.c[e].fn.apply(this.c[e].c||this,t);return this},h.prototype.off=function(t){if(t)for(var e=0;e<this.c.length;e++)this.c[e]===t&&(this.c.splice(e,1),e--);else this.c=[];return this},a.prototype.handleEvent=function(t){this[t.type](t)},a.prototype.touchstart=function(t){this.main.height()<this.page.height()&&(this.moved=!1,this.startX=t.touches[0].pageX-this.x,this.startY=t.touches[0].pageY-this.y,p.on(this.page.el,"touchmove",this),p.on(this.page.el,"touchend",this))},a.prototype.touchmove=function(t){this.lastX=this.x,this.lastY=this.y,this.x=t.touches[0].pageX-this.startX,this.y=t.touches[0].pageY-this.startY,1===t.touches.length&&Math.abs(this.y-this.lastY)>Math.abs(this.x-this.lastX)&&(t.preventDefault(),this.moved=!0,this.lastMoveTime=+new Date,this.page.morph.set("y",this.y))},a.prototype.touchend=function(t){if(p.off(this.page.el,"touchmove",this),p.off(this.page.el,"touchend",this),this.moved){t.preventDefault();var e=this.y-this.lastY,i=new Date-this.lastMoveTime+1;this.y=this.y+200*e/i;var n=this.clampY()?500:1e3;this.page.morph.duration(n).to("y",this.y).ease("cubic-bezier(0,0,0.2,1)").start()}},a.prototype.clampY=function(){return this.y>=0?(this.y=0,!0):this.y<this.main.height()-this.page.height()?(this.y=this.main.height()-this.page.height(),!0):void 0},a.prototype.destroy=function(){p.off(this.page.el,"touchstart",this)}}(window,document);